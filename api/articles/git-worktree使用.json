{"title":"git worktree使用","uid":"7a6e3dad18aab366d395a680cdf73288","slug":"git-worktree使用","date":"2022-11-03T08:24:51.000Z","updated":"2022-11-03T14:25:46.351Z","comments":true,"path":"api/articles/git-worktree使用.json","keywords":null,"cover":[],"content":"<p>使用<code>git worktree</code>同时在多个 branch 上工作。</p>\n<span id=\"more\"></span>\n<!-- markdownlint-disable MD041 MD002-->\n\n<p>参考<a href=\"https://blog.didispace.com/categories/Git/\">一些文章</a></p>\n<p><img src=\"https://pic1.zhimg.com/80/v2-1688c37a2c59e782b3d7e6b4f75ad7f4_1440w.webp\" alt=\"img\"></p>\n<pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\"><span class=\"token function\">git</span> worktree <span class=\"token function\">add</span> <span class=\"token punctuation\">[</span>-f<span class=\"token punctuation\">]</span> <span class=\"token punctuation\">[</span>--detach<span class=\"token punctuation\">]</span> <span class=\"token punctuation\">[</span>--checkout<span class=\"token punctuation\">]</span> <span class=\"token punctuation\">[</span>--lock <span class=\"token punctuation\">[</span>--reason <span class=\"token operator\">&lt;</span>string<span class=\"token operator\">&gt;</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span> <span class=\"token punctuation\">[</span>-b <span class=\"token operator\">&lt;</span>new-branch<span class=\"token operator\">&gt;</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">&lt;</span>path<span class=\"token operator\">&gt;</span> <span class=\"token punctuation\">[</span><span class=\"token operator\">&lt;</span>commit-ish<span class=\"token operator\">&gt;</span><span class=\"token punctuation\">]</span>\n<span class=\"token function\">git</span> worktree list <span class=\"token punctuation\">[</span>-v <span class=\"token operator\">|</span> <span class=\"token parameter variable\">--porcelain</span> <span class=\"token punctuation\">[</span>-z<span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span>\n<span class=\"token function\">git</span> worktree lock <span class=\"token punctuation\">[</span>--reason <span class=\"token operator\">&lt;</span>string<span class=\"token operator\">&gt;</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">&lt;</span>worktree<span class=\"token operator\">&gt;</span>\n<span class=\"token function\">git</span> worktree move <span class=\"token operator\">&lt;</span>worktree<span class=\"token operator\">&gt;</span> <span class=\"token operator\">&lt;</span>new-path<span class=\"token operator\">&gt;</span>\n<span class=\"token function\">git</span> worktree prune <span class=\"token punctuation\">[</span>-n<span class=\"token punctuation\">]</span> <span class=\"token punctuation\">[</span>-v<span class=\"token punctuation\">]</span> <span class=\"token punctuation\">[</span>--expire <span class=\"token operator\">&lt;</span>expire<span class=\"token operator\">&gt;</span><span class=\"token punctuation\">]</span>\n<span class=\"token function\">git</span> worktree remove <span class=\"token punctuation\">[</span>-f<span class=\"token punctuation\">]</span> <span class=\"token operator\">&lt;</span>worktree<span class=\"token operator\">&gt;</span>\n<span class=\"token function\">git</span> worktree repair <span class=\"token punctuation\">[</span><span class=\"token operator\">&lt;</span>path<span class=\"token operator\">&gt;</span><span class=\"token punctuation\">..</span>.<span class=\"token punctuation\">]</span>\n<span class=\"token function\">git</span> worktree unlock <span class=\"token operator\">&lt;</span>worktree<span class=\"token operator\">&gt;</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>使用git worktree可以仅需维护一个 repo，又可以同时在多个 branch 上工作，互不影响。免去分支切换的苦恼。</p>\n<pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\"> <span class=\"token function\">git</span> worktree <span class=\"token function\">add</span> <span class=\"token parameter variable\">-b</span> <span class=\"token string\">\"feature/feature1\"</span> <span class=\"token punctuation\">..</span>/feature/feature1\n <span class=\"token comment\"># 查看链接工作区下.git</span>\n <span class=\"token function\">cat</span> .git\n<span class=\"token comment\"># gitdir: /Users/dongyilong/test/git_test/demo-project/.git/worktrees/feature1</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p><img src=\"https://yilongdong-blog.oss-cn-hangzhou.aliyuncs.com/img/image-20221103204829664.png\" alt=\"image-20221103204829664\"></p>\n<pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\"><span class=\"token function\">git</span> worktree list <span class=\"token parameter variable\">--porcelain</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<p><img src=\"https://yilongdong-blog.oss-cn-hangzhou.aliyuncs.com/img/image-20221103204931170.png\" alt=\"image-20221103204931170\"></p>\n<pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\"><span class=\"token function\">git</span> worktree move <span class=\"token string\">\"feature/feature1\"</span> <span class=\"token punctuation\">..</span>/feature/feature2\n<span class=\"token comment\"># 不能移动主工作树或者包含子模块的工作树</span>\n<span class=\"token comment\"># 工作树的名字为demo-project， feature/feature2</span>\n<span class=\"token comment\"># git worktree list --porcelain</span>\nworktree /Users/dongyilong/test/git_test/demo-project\nHEAD e1da10447082e472ad8a2b57808d4ef9cec87823\nbranch refs/heads/master\n\nworktree /Users/dongyilong/test/git_test/feature/feature2\nHEAD e1da10447082e472ad8a2b57808d4ef9cec87823\nbranch refs/heads/feature/feature1<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p><img src=\"https://yilongdong-blog.oss-cn-hangzhou.aliyuncs.com/img/image-20221103205326277.png\" alt=\"image-20221103205326277\"></p>\n<pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\"><span class=\"token function\">git</span> worktree remove feature/feature2\n<span class=\"token function\">git</span> worktree remove <span class=\"token parameter variable\">-f</span> feature/feature2\n<span class=\"token function\">git</span> worktree prune <span class=\"token comment\"># 清除$GIT_DIR/worktrees中的工作树信息。</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span></span></code></pre>\n\n","text":"使用git worktree同时在多个 branch 上工作。 参考一些文章 git worktree add [-f] [--detach] [--checkout] [--lock [--reason &lt;string&gt;]] [-b &lt;new-branch&g...","link":"","photos":[],"count_time":{"symbolsCount":"1.3k","symbolsTime":"1 mins."},"categories":[{"name":"笔记","slug":"笔记","count":18,"path":"api/categories/笔记.json"}],"tags":[{"name":"git","slug":"git","count":3,"path":"api/tags/git.json"}],"toc":"","author":{"name":"YiLongDong","slug":"blog-author","avatar":"https://img-blog.csdnimg.cn/20210313122054101.png","link":"/","description":"","socials":{"github":"","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}},"mapped":true,"prev_post":{"title":"git commit规范","uid":"488532bb3413d4814952662362babd82","slug":"git-commit规范","date":"2022-11-03T13:12:55.000Z","updated":"2022-11-03T14:01:10.110Z","comments":true,"path":"api/articles/git-commit规范.json","keywords":null,"cover":[],"text":"点击阅读前文前, 首页能看到的文章的简短描述 http://www.ruanyifeng.com/blog/2016/01/commit_message_change_log.html Commit message 都包括三个部分：Header，Body 和 Footer。 &l...","link":"","photos":[],"count_time":{"symbolsCount":"2.1k","symbolsTime":"2 mins."},"categories":[{"name":"笔记","slug":"笔记","count":18,"path":"api/categories/笔记.json"}],"tags":[{"name":"git","slug":"git","count":3,"path":"api/tags/git.json"}],"author":{"name":"YiLongDong","slug":"blog-author","avatar":"https://img-blog.csdnimg.cn/20210313122054101.png","link":"/","description":"","socials":{"github":"","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}}},"next_post":{"title":"clang 编译链接","uid":"58a6ef8684392e221fda2f90c80f6f4d","slug":"clang-编译链接","date":"2022-11-03T01:02:21.000Z","updated":"2022-11-03T02:26:01.457Z","comments":true,"path":"api/articles/clang-编译链接.json","keywords":null,"cover":null,"text":"clang编译与搜索路径 如果在mac上自己编译了clang,llvm然后安装了，可能会出现找不到文件的错误。 可以在~/.zshrc中加入 alias clang++='clang++ -isysroot `xcrun --show-sdk-path` ' alias clan...","link":"","photos":[],"count_time":{"symbolsCount":"1k","symbolsTime":"1 mins."},"categories":[{"name":"笔记","slug":"笔记","count":18,"path":"api/categories/笔记.json"}],"tags":[{"name":"clang","slug":"clang","count":1,"path":"api/tags/clang.json"}],"author":{"name":"YiLongDong","slug":"blog-author","avatar":"https://img-blog.csdnimg.cn/20210313122054101.png","link":"/","description":"","socials":{"github":"","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}}}}